{% extends 'base.html' %}
{% load static %}

{% block title %}Upgrade to Premium - Tailora{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/settings.css' %}">
<style>
    .plan-card {
        background: #fff;
        border-radius: 0;
        padding: 32px;
        box-shadow: none;
        border: 1px solid #eee;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .plan-card:hover {
        border-color: #ddd;
    }
    
    .plan-card.featured {
        border: 2px solid #4CAF50;
    }
    
    .plan-card.featured::before {
        content: 'RECOMMENDED';
        position: absolute;
        top: 0;
        right: 0;
        background: linear-gradient(135deg, #4CAF50, #66bb6a);
        color: #fff;
        font-size: 10px;
        font-weight: 700;
        padding: 6px 16px;
        letter-spacing: 0.5px;
        border-radius: 0;
    }
    
    .plan-header {
        text-align: center;
        margin-bottom: 24px;
        padding-bottom: 24px;
        border-bottom: 1px solid #eee;
    }
    
    .plan-icon {
        font-size: 48px;
        margin-bottom: 12px;
    }
    
    .plan-name {
        font-family: 'Inter', sans-serif;
        font-size: 22px;
        font-weight: 700;
        color: #2c2c2c;
        margin: 0 0 8px 0;
    }
    
    .plan-price {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        color: #888;
    }
    
    .plan-features {
        list-style: none;
        padding: 0;
        margin: 0 0 24px 0;
    }
    
    .plan-features li {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 0;
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        color: #555;
        border-bottom: 1px solid #f5f5f5;
    }
    
    .plan-features li:last-child {
        border-bottom: none;
    }
    
    .plan-features li .check {
        width: 20px;
        height: 20px;
        background: linear-gradient(135deg, #4CAF50, #66bb6a);
        color: #fff;
        border-radius: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        font-weight: 700;
        flex-shrink: 0;
    }
    
    .plan-cta {
        margin-top: auto;
    }
    
    .payment-form {
        background: #fafafa;
        padding: 24px;
        border-radius: 0;
        margin-top: 20px;
    }
    
    .payment-form .input-field {
        margin-bottom: 16px;
    }
</style>
{% endblock %}

{% block container_class %}page-reveal{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
        <div>
            <h1 class="page-title">Upgrade to Premium</h1>
            <p class="page-subtitle">Unlock the full Tailora experience</p>
        </div>
        <div>
            <a href="{% url 'profile_settings' %}" class="btn btn-secondary">
                <span style="margin-right: 6px;">←</span> Settings
            </a>
        </div>
    </div>
</div>

<div class="settings-wrapper" style="max-width: 1100px;">
    <!-- Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="message {% if message.tags == 'error' %}message-error{% elif message.tags == 'success' %}message-success{% else %}message-info{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <!-- Plans Grid -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 24px;">
        
        <!-- Free Trial Plan -->
        <div class="plan-card">
            <div class="plan-header">
                <div class="plan-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#2c2c2c" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 12 20 22 4 22 4 12"></polyline><rect x="2" y="7" width="20" height="5"></rect><line x1="12" y1="22" x2="12" y2="7"></line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path></svg>
                </div>
                <h3 class="plan-name">7-Day Free Trial</h3>
                <p class="plan-price">Try before you commit</p>
            </div>
            
            <ul class="plan-features">
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    All Premium features for 7 days
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    No credit card required
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    Cancel anytime
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    Full AI recommendations access
                </li>
            </ul>
            
            <div class="plan-cta">
                <form method="post" action="{% url 'upgrade_account' %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="trial">
                    <button type="submit" class="btn btn-secondary" style="width: 100%; padding: 16px; font-size: 15px; border-radius: 0;">
                        <svg style="vertical-align: middle; margin-right: 6px;" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 2L11 13"></path><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                        Start Free Trial
                    </button>
                </form>
            </div>
        </div>

        <!-- Premium Plan -->
        <div class="plan-card featured">
            <div class="plan-header">
                <div class="plan-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="#ffc107" stroke="#ffc107" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
                </div>
                <h3 class="plan-name">Premium</h3>
                <p class="plan-price">Full access forever</p>
            </div>
            
            <ul class="plan-features">
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    <strong>Unlimited</strong> outfit combinations
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    <strong>1000</strong> wardrobe items (vs. 50 free)
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    AI-powered daily recommendations
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    Weather-based outfit suggestions
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    Premium profile badge
                </li>
                <li>
                    <span class="check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg></span>
                    Priority support
                </li>
            </ul>
            
            <div class="plan-cta">
                <form method="post" action="{% url 'upgrade_account' %}" id="premiumForm">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="upgrade">
                    
                    <div class="payment-form">
                        <div class="input-field">
                            <label for="card_number" class="input-label">Card Number</label>
                            <input type="text" id="card_number" name="card_number" 
                                   class="input-control" placeholder="4242 4242 4242 4242" required
                                   maxlength="19" style="letter-spacing: 1px;">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <div class="input-field">
                                <label for="expiry_date" class="input-label">Expiry</label>
                                <input type="text" id="expiry_date" name="expiry_date" 
                                       class="input-control" placeholder="MM/YY" required maxlength="5">
                            </div>
                            <div class="input-field">
                                <label for="cvc" class="input-label">CVC</label>
                                <input type="text" id="cvc" name="cvc" 
                                       class="input-control" placeholder="123" required maxlength="4">
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 16px; font-size: 15px; margin-top: 16px; background: linear-gradient(135deg, #4CAF50, #66bb6a); border: none; border-radius: 0;">
                        <svg style="vertical-align: middle; margin-right: 6px;" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                        Upgrade Now
                    </button>
                    <p style="text-align: center; font-size: 11px; color: #888; margin-top: 12px;">
                        <svg style="vertical-align: middle; margin-right: 4px;" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        Secure payment • Cancel anytime
                    </p>
                </form>
            </div>
        </div>
    </div>

    <!-- FAQ Section -->
    <div class="settings-main" style="margin-top: 32px;">
        <div class="settings-section" style="border-bottom: none; padding-bottom: 0;">
            <h3 class="section-title">Frequently Asked Questions</h3>
            
            <div style="display: grid; gap: 16px;">
                <div style="padding: 20px; background: #fafafa; border-radius: 0;">
                    <h4 style="font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600; color: #2c2c2c; margin: 0 0 8px 0;">
                        What happens after my trial ends?
                    </h4>
                    <p style="font-family: 'Inter', sans-serif; font-size: 13px; color: #666; margin: 0; line-height: 1.6;">
                        Your account will automatically revert to the free tier. You won't lose any data, but some premium features will become unavailable.
                    </p>
                </div>
                
                <div style="padding: 20px; background: #fafafa; border-radius: 0;">
                    <h4 style="font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600; color: #2c2c2c; margin: 0 0 8px 0;">
                        Can I cancel my subscription anytime?
                    </h4>
                    <p style="font-family: 'Inter', sans-serif; font-size: 13px; color: #666; margin: 0; line-height: 1.6;">
                        Yes! You can cancel at any time from your profile settings. Your premium access will continue until the end of your billing period.
                    </p>
                </div>
                
                <div style="padding: 20px; background: #fafafa; border-radius: 0;">
                    <h4 style="font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600; color: #2c2c2c; margin: 0 0 8px 0;">
                        Is my payment information secure?
                    </h4>
                    <p style="font-family: 'Inter', sans-serif; font-size: 13px; color: #666; margin: 0; line-height: 1.6;">
                        Absolutely. We use industry-standard encryption and never store your full card details on our servers.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Format card number with spaces
    document.getElementById('card_number').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\s/g, '').replace(/\D/g, '');
        let formatted = value.match(/.{1,4}/g)?.join(' ') || value;
        e.target.value = formatted;
    });
    
    // Format expiry date
    document.getElementById('expiry_date').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length >= 2) {
            value = value.slice(0, 2) + '/' + value.slice(2, 4);
        }
        e.target.value = value;
    });
    
    // Only numbers for CVC
    document.getElementById('cvc').addEventListener('input', function(e) {
        e.target.value = e.target.value.replace(/\D/g, '');
    });
</script>
{% endblock %}
