{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}{{ post.outfit.name }} ‚Ä¢ Tailora{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/wardrobe.css' %}">
<link rel="stylesheet" href="{% static 'css/social_v2.css' %}">
<style>
    /* =========================================
       THEME VARIABLES (Matched from Outfit Gallery)
       ========================================= */
    :root {
        --bg-color: #f8f8f8;
        --card-bg: #ffffff;
        --text-main: #1f1e1e;
        --text-muted: #757575;
        --border-color: #e0e0e0;
        --accent-color: #2c2c2c;
        --font-heading: 'Istok Web', sans-serif;
        --font-body: 'Inter', sans-serif;
    }

    body {
        background-color: var(--bg-color);
    }

    /* =========================================
       PAGE HEADER (Matched)
       ========================================= */
    .page-wrapper {
        max-width: 1400px;
        margin: 0 auto;
        padding: 40px 24px;
    }

    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 32px;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 24px;
    }

    .page-title {
        font-family: var(--font-heading);
        font-size: 32px;
        font-weight: 700;
        color: var(--text-main);
        margin: 0 0 4px 0;
        line-height: 1.2;
    }

    .page-subtitle {
        font-family: var(--font-body);
        font-size: 14px;
        color: var(--text-muted);
        margin: 0;
    }

    .header-actions {
        display: flex;
        gap: 12px;
    }

    .btn {
        border-radius: 0;
        padding: 10px 20px;
        font-family: var(--font-body);
        font-weight: 500;
        font-size: 14px;
        transition: all 0.2s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border: 1px solid transparent;
    }

    .btn-secondary {
        background: var(--card-bg);
        color: var(--text-main);
        border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
        border-color: var(--text-main);
        background: #f9f9f9;
        color: #000;
    }

    /* =========================================
       POST DETAIL SPLIT VIEW
       ========================================= */
    .pd-card {
        display: flex;
        background: #fff;
        width: 100%;
        max-width: 1100px;
        height: 80vh;
        max-height: 800px;
        min-height: 600px;
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        margin: 0 auto;
        /* Centered in wrapper */
    }

    /* --- Left Side: SLIDER Media --- */
    .pd-media-column {
        flex: 1.3;
        background: #000;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .slider-container {
        width: 100%;
        height: 100%;
        position: relative;
    }

    .slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.4s ease-in-out;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        /* Let clicks pass through inactive slides */
    }

    .slide.active {
        opacity: 1;
        pointer-events: auto;
        z-index: 1;
    }

    .slide img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    }

    /* AI Enhancement Filter Styles */
    .slide img.ai-filter-auto {
        filter: contrast(1.2) saturate(1.2);
    }

    .slide img.ai-filter-vibrant {
        filter: saturate(1.6) contrast(1.2);
    }

    .slide img.ai-filter-elegant {
        filter: sepia(0.2) contrast(1.1);
    }

    .slide img.ai-filter-vintage {
        filter: sepia(0.6) contrast(1.2) brightness(0.9);
    }

    .slide img.ai-filter-bright {
        filter: brightness(1.2) contrast(1.1) saturate(1.1);
    }

    /* Slider Controls */
    .slider-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.8);
        border: none;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        cursor: pointer;
        z-index: 10;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: #000;
        opacity: 0.7;
        transition: opacity 0.2s;
    }

    .slider-btn:hover {
        opacity: 1;
    }

    .slider-btn.prev {
        left: 16px;
    }

    .slider-btn.next {
        right: 16px;
    }

    .slider-dots {
        position: absolute;
        bottom: 16px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 6px;
        z-index: 10;
    }

    .dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.4);
        cursor: pointer;
    }

    .dot.active {
        background: #fff;
    }

    /* Badges Overlay */
    .pd-badge-overlay {
        position: absolute;
        top: 16px;
        left: 16px;
        z-index: 20;
        /* Above slider */
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .pd-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(4px);
        border-radius: 20px;
        font-family: var(--font-body);
        font-size: 11px;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .pd-badge.ai {
        color: #fff;
        background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
    }

    .pd-badge.iconic {
        color: #d32f2f;
        border: 1px solid #ffcdd2;
    }

    .pd-badge.star {
        color: #fbc02d;
        border: 1px solid #fff9c4;
    }

    .pd-badge.viral {
        color: #7b1fa2;
        border: 1px solid #e1bee7;
    }

    /* --- Right Side: Interaction --- */
    .pd-interaction-column {
        flex: 1;
        min-width: 350px;
        display: flex;
        flex-direction: column;
        border-left: 1px solid var(--border-color);
        background: #fff;
    }

    /* Header */
    .pd-header {
        padding: 14px 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid var(--border-color);
        height: 60px;
    }

    .pd-user-info {
        display: flex;
        align-items: center;
        gap: 12px;
        text-decoration: none;
        color: inherit;
    }

    .pd-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: #eee;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 14px;
        color: #555;
        border: 1px solid #dbdbdb;
    }

    .pd-username {
        font-weight: 600;
        font-size: 14px;
        color: var(--text-main);
        font-family: var(--font-body);
    }

    .pd-username:hover {
        text-decoration: underline;
    }

    /* More Menu (...) */
    .pd-more-btn {
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        color: var(--text-main);
    }

    .pd-more-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: #fff;
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-radius: 4px;
        display: none;
        min-width: 150px;
        z-index: 100;
    }

    .pd-menu-container {
        position: relative;
    }

    .pd-menu-container:hover .pd-more-dropdown {
        display: block;
    }

    .pd-menu-item {
        display: block;
        width: 100%;
        padding: 10px 16px;
        text-align: left;
        background: none;
        border: none;
        font-family: var(--font-body);
        font-size: 13px;
        color: var(--text-main);
        cursor: pointer;
        text-decoration: none;
    }

    .pd-menu-item:hover {
        background: #f9f9f9;
    }

    .pd-menu-item.delete {
        color: #d32f2f;
        border-top: 1px solid #eee;
    }

    /* Body */
    .pd-body {
        flex: 1;
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .pd-body::-webkit-scrollbar {
        width: 6px;
    }

    .pd-body::-webkit-scrollbar-track {
        background: transparent;
    }

    .pd-body::-webkit-scrollbar-thumb {
        background: #dbdbdb;
        border-radius: 3px;
    }

    .pd-caption-block {
        display: flex;
        gap: 12px;
        margin-bottom: 12px;
    }

    .pd-caption-text {
        font-size: 14px;
        line-height: 1.5;
        color: var(--text-main);
        font-family: var(--font-body);
    }

    .pd-tags {
        margin-top: 8px;
        font-size: 14px;
        color: #00376b;
        font-family: var(--font-body);
    }

    .pd-timestamp {
        font-size: 11px;
        color: var(--text-muted);
        margin-top: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-family: var(--font-body);
    }

    /* Comments */
    .pd-comment {
        display: flex;
        gap: 12px;
        margin-bottom: 16px;
        font-size: 14px;
        font-family: var(--font-body);
    }

    .pd-comment-content {
        flex: 1;
        overflow-wrap: break-word;
    }

    .pd-comment-actions {
        margin-top: 4px;
        display: flex;
        gap: 12px;
        font-size: 11px;
        color: var(--text-muted);
    }

    /* Outfit Card */
    .pd-outfit-card {
        background: #fafafa;
        border: 1px solid var(--border-color);
        padding: 12px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 0 0 12px 0;
    }

    .pd-outfit-info h4 {
        margin: 0;
        font-size: 14px;
        font-weight: 600;
        font-family: var(--font-body);
    }

    .pd-outfit-link {
        color: #0095f6;
        font-size: 13px;
        font-weight: 500;
        text-decoration: none;
        font-family: var(--font-body);
    }

    /* Footer */
    .pd-footer {
        border-top: 1px solid var(--border-color);
        background: #fff;
    }

    .pd-actions-row {
        padding: 12px 16px 8px;
        display: flex;
        justify-content: space-between;
    }

    .pd-action-btn {
        background: none;
        border: none;
        padding: 8px;
        margin: -8px;
        cursor: pointer;
        color: var(--text-main);
    }

    .pd-action-btn.liked {
        color: #ed4956;
    }

    .pd-likes-count {
        padding: 0 16px;
        font-weight: 600;
        font-size: 14px;
        margin-bottom: 8px;
        font-family: var(--font-body);
    }

    .pd-add-comment {
        border-top: 1px solid var(--border-color);
        padding: 12px 16px;
        display: flex;
        align-items: center;
    }

    .pd-comment-input {
        width: 100%;
        border: none;
        outline: none;
        font-size: 14px;
        height: 18px;
        resize: none;
        font-family: var(--font-body);
    }

    .pd-post-btn {
        background: none;
        border: none;
        color: #0095f6;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        opacity: 0.5;
        font-family: var(--font-body);
    }

    .pd-comment-input:not(:placeholder-shown)+.pd-post-btn {
        opacity: 1;
    }

    /* Mobile */
    @media (max-width: 900px) {
        .pd-card {
            flex-direction: column;
            height: auto;
            max-height: none;
            max-width: 100%;
            border: none;
            box-shadow: none;
        }

        .pd-media-column {
            height: auto;
            aspect-ratio: 1/1;
        }

        .slider-container {
            height: 100%;
        }

        .pd-interaction-column {
            border: none;
        }

        .pd-body {
            overflow: visible;
            height: auto;
        }

        .page-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 16px;
        }

        .header-actions {
            width: 100%;
        }

        .btn {
            flex: 1;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="page-wrapper">

    <!-- PAGE HEADER (Same design language as My Outfits) -->
    <header class="page-header">
        <div>
            <h1 class="page-title">{{ post.outfit.name }}</h1>
            <p class="page-subtitle">Posted by {{ post.user.get_full_name }} ‚Ä¢ {{ post.created_at|date:"F j, Y" }}</p>
        </div>
        <div class="header-actions">
            <a href="{% url 'social:feed' %}" class="btn btn-secondary">Back to Feed</a>
            <a href="{% url 'outfits:outfit_detail' post.outfit.id %}" class="btn btn-secondary">View Outfit</a>
        </div>
    </header>

    <!-- MAIN CONTENT CARD -->
    <div class="pd-card">

        <!-- LEFT: Media Slider -->
        <div class="pd-media-column">

            <div class="pd-badge-overlay">
                {% if post.likes_count >= 200 %}
                <span class="pd-badge iconic">üî• Iconic</span>
                {% elif post.likes_count >= 100 %}
                <span class="pd-badge star">‚≠ê Star</span>
                {% elif post.likes_count >= 50 %}
                <span class="pd-badge viral">üöÄ Viral</span>
                {% endif %}

                {% if post.enhanced_images or post.enhancement_style %}
                <span class="pd-badge ai">‚ú® AI Enhanced</span>
                {% endif %}
            </div>

            {% with items=post.outfit.items.all %}
            <div class="slider-container" id="postSlider">
                {% if items|length == 0 %}
                <div class="slide active">
                    <span style="color: #fff;">No images available</span>
                </div>
                {% else %}
                {% for item in items %}
                <div class="slide {% if forloop.first %}active{% endif %}" data-index="{{ forloop.counter0 }}">
                    {% if post.enhanced_images and item.id|stringformat:"s" in post.enhanced_images %}
                    <img src="/media/{{ post.enhanced_images|get_item:item.id|stringformat:'s' }}" alt="AI Enhanced"
                        class="{% if post.enhancement_style %}ai-filter-{{ post.enhancement_style }}{% endif %}">
                    {% elif item.image %}
                    <img src="{{ item.image.url }}" alt="{{ item.name }}"
                        class="{% if post.enhancement_style %}ai-filter-{{ post.enhancement_style }}{% endif %}">
                    {% else %}
                    <div style="color: #fff; padding: 20px;">No Image</div>
                    {% endif %}
                </div>
                {% endfor %}
                {% endif %}

                {% if items|length > 1 %}
                <button class="slider-btn prev" id="btnPrev">‚Äπ</button>
                <button class="slider-btn next" id="btnNext">‚Ä∫</button>

                <div class="slider-dots">
                    {% for item in items %}
                    <div class="dot {% if forloop.first %}active{% endif %}" data-index="{{ forloop.counter0 }}"></div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endwith %}
        </div>

        <!-- RIGHT: Interactions -->
        <div class="pd-interaction-column">

            <div class="pd-header">
                <a href="{% url 'social:profile' post.user.id %}" class="pd-user-info">
                    {% if post.user.profile_image and post.user.profile_image.name %}
                    <img src="{{ post.user.profile_image.url }}" alt="{{ post.user.get_full_name }}" class="pd-avatar"
                        style="object-fit: cover;">
                    {% else %}
                    <div class="pd-avatar">{{ post.user.first_name|slice:":1"|upper }}</div>
                    {% endif %}
                    <div class="pd-username">{{ post.user.get_full_name }}</div>
                </a>

                {% if post.user == request.user %}
                <div class="pd-menu-container">
                    <button class="pd-more-btn" title="More options">
                        <svg aria-label="More options" class="_8-yf5 " fill="#262626" height="24" role="img"
                            viewBox="0 0 24 24" width="24">
                            <circle cx="12" cy="12" r="1.5"></circle>
                            <circle cx="6" cy="12" r="1.5"></circle>
                            <circle cx="18" cy="12" r="1.5"></circle>
                        </svg>
                    </button>
                    <div class="pd-more-dropdown">
                        <a href="{% url 'social:edit_post' post.id %}" class="pd-menu-item">Edit Post</a>
                        <form method="post" action="{% url 'social:delete_post' post.id %}" style="margin:0;"
                            onsubmit="return confirm('Are you sure you want to delete this post?');">
                            {% csrf_token %}
                            <button type="submit" class="pd-menu-item delete">Delete Post</button>
                        </form>
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="pd-body">

                <!-- Embedded Compact Outfit Card -->
                <div class="pd-outfit-card">
                    <div class="pd-outfit-info">
                        <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Featured
                            Outfit</div>
                        <h4 style="margin-top: 2px;">{{ post.outfit.name }}</h4>
                    </div>
                    <a href="{% url 'outfits:outfit_detail' post.outfit.id %}" class="pd-outfit-link">View Details</a>
                </div>

                <!-- Caption -->
                <div class="pd-caption-block">
                    <a href="{% url 'social:profile' post.user.id %}"
                        style="text-decoration:none; height: fit-content;">
                        {% if post.user.profile_image and post.user.profile_image.name %}
                        <img src="{{ post.user.profile_image.url }}" alt="{{ post.user.get_full_name }}"
                            class="pd-avatar" style="object-fit: cover;">
                        {% else %}
                        <div class="pd-avatar">{{ post.user.first_name|slice:":1"|upper }}</div>
                        {% endif %}
                    </a>
                    <div>
                        <span class="pd-username" style="margin-right: 4px;">{{ post.user.get_full_name }}</span>
                        <span class="pd-caption-text">{{ post.caption }}</span>

                        {% if post.hashtags %}
                        <div class="pd-tags">
                            {% for tag in post.hashtags %}
                            <span>#{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}

                        <div class="pd-timestamp">{{ post.created_at|timesince }} AGO</div>
                    </div>
                </div>

                <!-- Comments -->
                {% for comment in comments %}
                <div class="pd-comment">
                    <a href="{% url 'social:profile' comment.user.id %}"
                        style="text-decoration:none; height: fit-content;">
                        {% if comment.user.profile_image and comment.user.profile_image.name %}
                        <img src="{{ comment.user.profile_image.url }}" alt="{{ comment.user.get_full_name }}"
                            class="pd-avatar" style="width: 24px; height: 24px; object-fit: cover;">
                        {% else %}
                        <div class="pd-avatar" style="width: 24px; height: 24px; font-size: 10px;">{{
                            comment.user.first_name|slice:":1"|upper }}</div>
                        {% endif %}
                    </a>
                    <div class="pd-comment-content">
                        <span class="pd-username" style="margin-right: 4px;">{{ comment.user.get_full_name }}</span>
                        <span style="color: var(--text-main);">{{ comment.content }}</span>
                        <div class="pd-comment-actions">
                            <span>{{ comment.created_at|timesince }} ago</span>
                            {% if comment.user == request.user or post.user == request.user %}
                            <form method="post" action="{% url 'social:delete_comment' comment.id %}"
                                style="display:inline;">
                                {% csrf_token %}
                                <button
                                    style="border:none; background:none; color:inherit; font-weight:600; cursor:pointer; font-size:10px;">Delete</button>
                            </form>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% empty %}
                <div style="text-align: center; color: var(--text-muted); padding: 20px; font-size: 13px;">
                    No comments yet.
                </div>
                {% endfor %}
            </div>

            <!-- Footer -->
            <div class="pd-footer">
                <div class="pd-actions-row">
                    <div style="display: flex; gap: 16px;">
                        <form method="post" action="{% url 'social:toggle_like' post.id %}" style="margin:0;">
                            {% csrf_token %}
                            <button type="submit" class="pd-action-btn {% if post.is_liked %}liked{% endif %}">
                                {% if post.is_liked %}
                                <svg aria-label="Unlike" fill="#ed4956" height="24" role="img" viewBox="0 0 48 48"
                                    width="24">
                                    <path
                                        d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z">
                                    </path>
                                </svg>
                                {% else %}
                                <svg aria-label="Like" fill="#262626" height="24" role="img" viewBox="0 0 24 24"
                                    width="24">
                                    <path
                                        d="M16.792 3.904A4.989 4.989 0 0 1 21.5 9.122c0 3.072-2.652 4.956-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 0 1 4.708-5.218 4.21 4.21 0 0 1 3.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 0 1 3.679-1.938m0-2a6.04 6.04 0 0 0-4.797 2.127 6.052 6.052 0 0 0-4.787-2.127A6.985 6.985 0 0 0 .5 9.122c0 3.632 2.967 6.316 5.862 8.656 2.533 2.053 4.673 3.654 4.896 3.82.261.2.668.225.965.07a1.64 1.64 0 0 0 .61-.39c.28-.21 2.37-1.78 4.906-3.83 2.894-2.339 5.86-5.023 5.86-8.656a6.985 6.985 0 0 0-6.799-6.918Z">
                                    </path>
                                </svg>
                                {% endif %}
                            </button>
                        </form>

                        <button class="pd-action-btn" onclick="document.querySelector('.pd-comment-input').focus()">
                            <svg aria-label="Comment" fill="#262626" height="24" role="img" viewBox="0 0 24 24"
                                width="24">
                                <path d="M20.656 17.008a9.993 9.993 0 1 0-3.59 3.615L22 22Z" fill="none"
                                    stroke="currentColor" stroke-linejoin="round" stroke-width="2"></path>
                            </svg>
                        </button>

                        <button class="pd-action-btn">
                            <svg aria-label="Share Post" fill="#262626" height="24" role="img" viewBox="0 0 24 24"
                                width="24">
                                <line fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="2" x1="22"
                                    x2="9.218" y1="3" y2="10.083"></line>
                                <polygon fill="none" points="11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334"
                                    stroke="currentColor" stroke-linejoin="round" stroke-width="2"></polygon>
                            </svg>
                        </button>
                    </div>

                    <form method="post" action="{% url 'social:toggle_save' post.id %}" style="margin:0;">
                        {% csrf_token %}
                        <button type="submit" class="pd-action-btn {% if post.is_saved %}saved{% endif %}">
                            {% if post.is_saved %}
                            <svg aria-label="Remove" fill="#262626" height="24" role="img" viewBox="0 0 24 24"
                                width="24">
                                <path
                                    d="M20 22a.999.999 0 0 1-.685-.273L12 14.815l-7.315 6.912A1 1 0 0 1 3 21V3a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v18a1 1 0 0 1-1.315.918Z">
                                </path>
                            </svg>
                            {% else %}
                            <svg aria-label="Save" fill="#262626" height="24" role="img" viewBox="0 0 24 24" width="24">
                                <polygon fill="none" points="20 21 12 13.44 4 21 4 3 20 3 20 21" stroke="currentColor"
                                    stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></polygon>
                            </svg>
                            {% endif %}
                        </button>
                    </form>
                </div>

                <div class="pd-likes-count">{{ post.likes_count }} likes</div>

                <form method="post" action="{% url 'social:add_comment' post.id %}" class="pd-add-comment">
                    {% csrf_token %}
                    <textarea name="content" class="pd-comment-input" placeholder="Add a comment..."
                        required></textarea>
                    <button type="submit" class="pd-post-btn">Post</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');
        const btnPrev = document.getElementById('btnPrev');
        const btnNext = document.getElementById('btnNext');

        let currentIndex = 0;
        const totalSlides = slides.length;

        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));

            slides[index].classList.add('active');
            if (dots[index]) dots[index].classList.add('active');

            currentIndex = index;
        }

        if (btnNext) {
            btnNext.addEventListener('click', () => {
                let nextIndex = (currentIndex + 1) % totalSlides;
                showSlide(nextIndex);
            });
        }

        if (btnPrev) {
            btnPrev.addEventListener('click', () => {
                let prevIndex = (currentIndex - 1 + totalSlides) % totalSlides;
                showSlide(prevIndex);
            });
        }

        dots.forEach(dot => {
            dot.addEventListener('click', (e) => {
                const index = parseInt(e.target.dataset.index);
                showSlide(index);
            });
        });
    });
</script>
{% endblock %}