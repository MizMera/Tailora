{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up - Tailora</title>
    <link rel="stylesheet" href="{% static 'css/auth.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="auth-container">
        <!-- Left Side - Wardrobe Image -->
        <div class="auth-image-section">
            <img src="{% static 'images/signup_pic.jpg' %}" 
                 alt="Wardrobe"
                 class="auth-image">
        </div>

        <!-- Right Side - Register Form -->
        <div class="auth-form-section">
            <div class="auth-content">
                <!-- Header -->
                <div class="auth-header">
                    <h1 class="auth-title">Tailora</h1>
                    <p class="auth-subtitle">Style tailored for you</p>
                </div>

                <!-- Register Form -->
                <form method="post" action="{% url 'register' %}" class="auth-form" id="registerForm">
                    {% csrf_token %}
                    
                    <div class="auth-form-container">
                        <!-- Step Indicator -->
                        <div class="step-indicator">
                            <div class="step active" data-step="1">
                                <div class="step-number">1</div>
                                <div class="step-label">Information</div>
                            </div>
                            <div class="step-line"></div>
                            <div class="step" data-step="2">
                                <div class="step-number">2</div>
                                <div class="step-label">Preferences</div>
                            </div>
                        </div>

                        <!-- Display Errors -->
                        {% if form.errors %}
                        <div class="form-errors">
                            <ul>
                                {% for field, errors in form.errors.items %}
                                    {% for error in errors %}
                                        <li>{{ error }}</li>
                                    {% endfor %}
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        {% if messages %}
                            {% for message in messages %}
                                <div class="{% if message.tags == 'error' %}form-errors{% else %}success-message{% endif %}">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        {% endif %}

                        <!-- Multi-step Form Container -->
                        <div class="form-steps-container">
                            <!-- Step 1: Basic Information -->
                            <div class="form-step active" data-step="1">
                                <div class="form-section">
                            <h3 class="section-title">Basic information</h3>
                            
                            <!-- Email Field -->
                            <div class="input-field">
                                <label for="email" class="input-label">Email *</label>
                                <div class="input-wrapper">
                                    <input 
                                        type="email" 
                                        id="email" 
                                        name="email" 
                                        class="input-control" 
                                        placeholder="your.email@example.com"
                                        value="{{ form.email.value|default:'' }}"
                                        required
                                    >
                                </div>
                            </div>

                            <!-- Username Field -->
                            <div class="input-field">
                                <label for="username" class="input-label">Username *</label>
                                <div class="input-wrapper">
                                    <input 
                                        type="text" 
                                        id="username" 
                                        name="username" 
                                        class="input-control" 
                                        placeholder="Your username"
                                        value="{{ form.username.value|default:'' }}"
                                        required
                                    >
                                </div>
                            </div>

                            <!-- Phone Field -->
                            <div class="input-field">
                                <label for="phone" class="input-label">Phone</label>
                                <div class="input-wrapper">
                                    <input 
                                        type="tel" 
                                        id="phone" 
                                        name="phone" 
                                        class="input-control" 
                                        placeholder="+33 6 12 34 56 78"
                                        value="{{ form.phone.value|default:'' }}"
                                    >
                                </div>
                            </div>

                            <!-- Password Field -->
                            <div class="input-field">
                                <label for="password" class="input-label">Password *</label>
                                <div class="input-wrapper">
                                    <input 
                                        type="password" 
                                        id="password" 
                                        name="password" 
                                        class="input-control" 
                                        placeholder="••••••••"
                                        required
                                    >
                                </div>
                                <small class="input-hint">Minimum 8 characters</small>
                            </div>
                                </div>

                                <!-- Step 1 Navigation -->
                                <div class="step-navigation">
                                    <a href="{% url 'login' %}" class="text-link">Already have an account?</a>
                                    <button type="button" class="btn btn-primary" id="nextStep">Next</button>
                                </div>
                            </div>

                            <!-- Step 2: Style Preferences -->
                            <div class="form-step" data-step="2">
                                <div class="form-section">
                                    <h3 class="section-title">Style preferences</h3>
                                    
                                    <!-- Preferred Styles -->
                                    <div class="input-field">
                                        <label class="input-label">Preferred styles</label>
                                        <div class="checkbox-grid">
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="casual">
                                                <span>Casual</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="chic">
                                                <span>Chic</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="boheme">
                                                <span>Bohemian</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="sportif">
                                                <span>Sporty</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="elegant">
                                                <span>Elegant</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="classique">
                                                <span>Classic</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="streetwear">
                                                <span>Streetwear</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="vintage">
                                                <span>Vintage</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="preferred_styles" value="minimaliste">
                                                <span>Minimalist</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Body Type -->
                                    <div class="input-field">
                                        <label for="body_type" class="input-label">Body type</label>
                                        <select id="body_type" name="body_type" class="input-control">
                                            <option value="">Select your body type</option>
                                            <option value="rectangle">Rectangle</option>
                                            <option value="triangle">Triangle</option>
                                            <option value="triangle_inverse">Inverted Triangle</option>
                                            <option value="sablier">Hourglass</option>
                                            <option value="ovale">Oval</option>
                                        </select>
                                    </div>

                                    <!-- Height -->
                                    <div class="input-field">
                                        <label for="height" class="input-label">Height (cm)</label>
                                        <div class="input-wrapper">
                                            <input 
                                                type="number" 
                                                id="height" 
                                                name="height" 
                                                class="input-control" 
                                                placeholder="170"
                                                min="100"
                                                max="250"
                                                value="{{ form.height.value|default:'' }}"
                                            >
                                        </div>
                                    </div>

                                    <!-- Favorite Colors -->
                                    <div class="input-field">
                                        <label class="input-label">Favorite colors</label>
                                        <div class="color-grid">
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#000000">
                                                <span class="color-box color-black"></span>
                                                <span class="color-name">Black</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#FFFFFF">
                                                <span class="color-box color-white"></span>
                                                <span class="color-name">White</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#808080">
                                                <span class="color-box color-gray"></span>
                                                <span class="color-name">Grey</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#0000FF">
                                                <span class="color-box color-blue"></span>
                                                <span class="color-name">Blue</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#FF0000">
                                                <span class="color-box color-red"></span>
                                                <span class="color-name">Red</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#008000">
                                                <span class="color-box color-green"></span>
                                                <span class="color-name">Green</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#FFFF00">
                                                <span class="color-box color-yellow"></span>
                                                <span class="color-name">Yellow</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#FFC0CB">
                                                <span class="color-box color-pink"></span>
                                                <span class="color-name">Pink</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#A52A2A">
                                                <span class="color-box color-brown"></span>
                                                <span class="color-name">Brown</span>
                                            </label>
                                            <label class="color-item">
                                                <input type="checkbox" name="favorite_colors" value="#F5DEB3">
                                                <span class="color-box color-beige"></span>
                                                <span class="color-name">Beige</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Preferences -->
                                    <div class="input-field">
                                        <label class="input-label">Shopping preferences</label>
                                        <div class="checkbox-list">
                                            <label class="checkbox-item-inline">
                                                <input type="checkbox" name="prefers_sustainable" value="true">
                                                <span>I prefer eco-friendly brands</span>
                                            </label>
                                            <label class="checkbox-item-inline">
                                                <input type="checkbox" name="prefers_secondhand" value="true">
                                                <span>I like second-hand</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Step 2 Navigation -->
                                <div class="step-navigation">
                                    <button type="button" class="btn btn-secondary" id="prevStep">Back</button>
                                    <button type="submit" class="btn btn-primary">Sign up</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    
                </form>
            </div>
        </div>
    </div>

    <script>
        // Smooth page transitions
        function initPageTransitions() {
            // Add fade transition to all links
            const links = document.querySelectorAll('a:not([target="_blank"])');
            
            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    // Check if it's a valid internal link
                    if (href && !href.startsWith('#') && !href.startsWith('javascript:')) {
                        e.preventDefault();
                        
                        // Add fade-out class
                        document.body.classList.add('fade-out');
                        
                        // Navigate after animation
                        setTimeout(() => {
                            window.location.href = href;
                        }, 300);
                    }
                });
            });
        }

        // Multi-step form navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize page transitions
            initPageTransitions();

            const form = document.getElementById('registerForm');
            const steps = document.querySelectorAll('.form-step');
            const stepIndicators = document.querySelectorAll('.step');
            const nextBtn = document.getElementById('nextStep');
            const prevBtn = document.getElementById('prevStep');
            let currentStep = 1;

            function showStep(stepNumber) {
                steps.forEach(step => {
                    step.classList.remove('active', 'slide-out-left', 'slide-out-right');
                });
                
                stepIndicators.forEach(indicator => {
                    indicator.classList.remove('active');
                });

                const targetStep = document.querySelector(`.form-step[data-step="${stepNumber}"]`);
                const targetIndicator = document.querySelector(`.step[data-step="${stepNumber}"]`);
                
                if (targetStep) {
                    targetStep.classList.add('active');
                }
                
                if (targetIndicator) {
                    targetIndicator.classList.add('active');
                }

                currentStep = stepNumber;
            }

            function validateStep1() {
                const email = document.getElementById('email').value.trim();
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value.trim();

                if (!email || !username || !password) {
                    alert('Please fill in all required fields.');
                    return false;
                }

                if (password.length < 8) {
                    alert('Password must be at least 8 characters.');
                    return false;
                }

                // Basic email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    alert('Please enter a valid email address.');
                    return false;
                }

                return true;
            }

            nextBtn.addEventListener('click', function() {
                if (validateStep1()) {
                    showStep(2);
                }
            });

            prevBtn.addEventListener('click', function() {
                showStep(1);
            });

            // Add fade transition to form submission
            form.addEventListener('submit', function() {
                document.body.classList.add('fade-out');
            });

            // Initialize
            showStep(1);
        });
    </script>
</body>
</html>
