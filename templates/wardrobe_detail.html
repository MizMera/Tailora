{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ item.name }} - Tailora</title>
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'css/wardrobe.css' %}">
</head>
<body>
    <div class="dashboard-container wardrobe-detail-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <a href="{% url 'wardrobe_gallery' %}" class="back-link">&larr; Ma garde-robe</a>
                <h1>{{ item.name }}</h1>
            </div>
            <div class="header-right">
                <a href="{% url 'wardrobe_edit' item.id %}" class="btn btn-secondary">Modifier</a>
                <a href="{% url 'wardrobe_gallery' %}" class="btn btn-secondary">Fermer</a>
            </div>
        </header>

        <!-- Detail Layout -->
        <div class="detail-layout">
            <!-- Left: Image -->
            <div class="detail-image-section">
                <div class="detail-image">
                    <img src="{{ item.image.url }}" alt="{{ item.name }}">
                    {% if item.status != 'available' %}
                    <div class="status-overlay">
                        {% if item.status == 'washing' %}Au lavage
                        {% elif item.status == 'dry_cleaning' %}Au pressing
                        {% elif item.status == 'loaned' %}Prêté
                        {% elif item.status == 'repair' %}En réparation
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                
                <div class="detail-actions">
                    <form method="post" action="{% url 'wardrobe_toggle_favorite' item.id %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-large {% if item.favorite %}favorite-active{% endif %}">
                            {% if item.favorite %}★ Favori{% else %}☆ Ajouter aux favoris{% endif %}
                        </button>
                    </form>
                    <a href="{% url 'wardrobe_delete' item.id %}" class="btn btn-large btn-danger">Supprimer</a>
                </div>
            </div>

            <!-- Right: Information -->
            <div class="detail-info-section">
                <!-- Basic Info -->
                <div class="info-card">
                    <h2 class="card-title">Informations</h2>
                    
                    <div class="info-row">
                        <span class="info-label">Catégorie</span>
                        <span class="info-value">
                            {% if item.category %}
                            {{ item.category.icon }} {{ item.category.name }}
                            {% else %}
                            <em>Non spécifiée</em>
                            {% endif %}
                        </span>
                    </div>

                    <div class="info-row">
                        <span class="info-label">Couleur</span>
                        <span class="info-value">
                            <span class="color-dot" style="background-color: {{ item.color_hex|default:item.color }}"></span>
                            {{ item.color }}
                        </span>
                    </div>

                    <div class="info-row">
                        <span class="info-label">Motif</span>
                        <span class="info-value">
                            {% if item.pattern %}{{ item.pattern }}{% else %}<em>Aucun</em>{% endif %}
                        </span>
                    </div>

                    <div class="info-row">
                        <span class="info-label">Marque</span>
                        <span class="info-value">
                            {% if item.brand %}{{ item.brand }}{% else %}<em>Non spécifiée</em>{% endif %}
                        </span>
                    </div>

                    <div class="info-row">
                        <span class="info-label">Matière</span>
                        <span class="info-value">
                            {% if item.material %}{{ item.material }}{% else %}<em>Non spécifiée</em>{% endif %}
                        </span>
                    </div>

                    <div class="info-row">
                        <span class="info-label">État</span>
                        <span class="info-value">
                            <span class="badge condition-{{ item.condition }}">
                                {% if item.condition == 'new' %}Neuf
                                {% elif item.condition == 'excellent' %}Excellent
                                {% elif item.condition == 'good' %}Bon
                                {% elif item.condition == 'fair' %}Correct
                                {% elif item.condition == 'worn' %}Usé
                                {% endif %}
                            </span>
                        </span>
                    </div>

                    <div class="info-row">
                        <span class="info-label">Statut</span>
                        <span class="info-value">
                            <span class="badge status-{{ item.status }}">
                                {% if item.status == 'available' %}Disponible
                                {% elif item.status == 'washing' %}Au lavage
                                {% elif item.status == 'dry_cleaning' %}Au pressing
                                {% elif item.status == 'loaned' %}Prêté
                                {% elif item.status == 'repair' %}En réparation
                                {% endif %}
                            </span>
                        </span>
                    </div>
                </div>

                <!-- Saisons et Occasions -->
                {% if item.seasons or item.occasions %}
                <div class="info-card">
                    <h2 class="card-title">Utilisation</h2>
                    
                    {% if item.seasons %}
                    <div class="info-section">
                        <label class="info-label">Saisons</label>
                        <div class="tags-list">
                            {% for season in item.seasons %}
                            <span class="tag">
                                {% if season == 'spring' %}Printemps
                                {% elif season == 'summer' %}Été
                                {% elif season == 'fall' %}Automne
                                {% elif season == 'winter' %}Hiver
                                {% elif season == 'all_seasons' %}Toutes saisons
                                {% endif %}
                            </span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    {% if item.occasions %}
                    <div class="info-section">
                        <label class="info-label">Occasions</label>
                        <div class="tags-list">
                            {% for occasion in item.occasions %}
                            <span class="tag">
                                {% if occasion == 'casual' %}Casual
                                {% elif occasion == 'formal' %}Formel
                                {% elif occasion == 'sport' %}Sport
                                {% elif occasion == 'party' %}Soirée
                                {% elif occasion == 'work' %}Travail
                                {% else %}{{ occasion }}
                                {% endif %}
                            </span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                <!-- Purchase Info -->
                {% if item.purchase_date or item.purchase_price or item.purchase_location %}
                <div class="info-card">
                    <h2 class="card-title">Achat</h2>
                    
                    {% if item.purchase_date %}
                    <div class="info-row">
                        <span class="info-label">Date</span>
                        <span class="info-value">{{ item.purchase_date|date:'d/m/Y' }}</span>
                    </div>
                    {% endif %}

                    {% if item.purchase_price %}
                    <div class="info-row">
                        <span class="info-label">Prix</span>
                        <span class="info-value">{{ item.purchase_price }} EUR</span>
                    </div>
                    {% endif %}

                    {% if item.purchase_location %}
                    <div class="info-row">
                        <span class="info-label">Lieu</span>
                        <span class="info-value">{{ item.purchase_location }}</span>
                    </div>
                    {% endif %}

                    {% if item.is_secondhand %}
                    <div class="info-row">
                        <span class="info-value">
                            <span class="badge badge-secondhand">Article de seconde main</span>
                        </span>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                <!-- Usage Stats -->
                <div class="info-card">
                    <h2 class="card-title">Utilisation</h2>
                    
                    <div class="info-row">
                        <span class="info-label">Porté</span>
                        <span class="info-value">{{ item.times_worn }} fois</span>
                    </div>

                    {% if item.last_worn %}
                    <div class="info-row">
                        <span class="info-label">Dernier port</span>
                        <span class="info-value">{{ item.last_worn|date:'d/m/Y' }}</span>
                    </div>
                    {% endif %}

                    <div class="info-row">
                        <span class="info-label">Ajouté</span>
                        <span class="info-value">{{ item.created_at|date:'d/m/Y' }}</span>
                    </div>
                </div>

                <!-- Tags -->
                {% if item.tags %}
                <div class="info-card">
                    <h2 class="card-title">Étiquettes</h2>
                    <div class="tags-list">
                        {% for tag in item.tags %}
                        <span class="tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Description -->
                {% if item.description %}
                <div class="info-card">
                    <h2 class="card-title">Description</h2>
                    <p class="description-text">{{ item.description }}</p>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Actions Footer -->
        <div class="detail-footer">
            <a href="{% url 'wardrobe_edit' item.id %}" class="btn btn-primary btn-lg">Modifier cet article</a>
            <a href="{% url 'wardrobe_gallery' %}" class="btn btn-secondary btn-lg">Retour à la galerie</a>
        </div>
    </div>

    <style>
        body {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</body>
</html>
