{% extends 'base.html' %}
{% load static %}

{% block title %}Delete {{ item.name }} - Tailora{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<style>
    .danger-container {
        max-width: 800px;
        margin: 0 auto;
    }

    .warning-card {
        background: #fff5f5;
        border: 2px solid #ff6b6b;
        padding: 32px;
        margin-bottom: 32px;
    }

    .warning-card-title {
        font-family: 'Inter', sans-serif;
        font-size: 18px;
        font-weight: 600;
        color: #c62828;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .warning-card-text {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        color: #721c24;
        line-height: 1.6;
        margin: 0;
    }

    .item-preview-card {
        background: #ffffff;
        border: 1px solid #e0e0e0;
        padding: 32px;
        margin-bottom: 32px;
    }

    .item-preview-grid {
        display: grid;
        grid-template-columns: 200px 1fr;
        gap: 32px;
        align-items: start;
    }

    .item-preview-image {
        width: 200px;
        height: 267px;
        background: #f5f5f5;
        border: 1px solid #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .item-preview-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .item-preview-details h3 {
        font-family: 'Inter', sans-serif;
        font-size: 24px;
        font-weight: 600;
        color: #252320;
        margin: 0 0 16px 0;
    }

    .item-detail-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .item-detail-list li {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        color: #252320;
        padding: 8px 0;
        border-bottom: 1px solid #f0f0f0;
    }

    .item-detail-list li:last-child {
        border-bottom: none;
    }

    .item-detail-label {
        color: #757575;
        font-weight: 500;
        margin-right: 8px;
    }

    .delete-form-card {
        background: #ffffff;
        border: 1px solid #e0e0e0;
        padding: 32px;
        margin-bottom: 24px;
    }

    .form-section-title {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        font-weight: 600;
        color: #252320;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 24px;
        padding-bottom: 12px;
        border-bottom: 2px solid #2c2c2c;
    }

    .form-actions-danger {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-top: 24px;
    }

    .btn-cancel {
        background: #cdcdcd;
        color: #252320;
        padding: 14px 24px;
        border: none;
        font-family: 'Istok Web', sans-serif;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        text-align: center;
        display: inline-block;
    }

    .btn-cancel:hover {
        background: #b8b8b8;
    }

    @media (max-width: 768px) {
        .item-preview-grid {
            grid-template-columns: 1fr;
        }

        .item-preview-image {
            width: 100%;
            height: auto;
            aspect-ratio: 3/4;
        }

        .form-actions-danger {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <h1 class="page-title">Delete Item</h1>
        <p class="page-subtitle">Remove from wardrobe</p>
    </div>
</div>

<div class="content-section">
    <div class="danger-container">
        <div class="warning-card">
            <div class="warning-card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z">
                    </path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                Confirm Deletion
            </div>
            <p class="warning-card-text">
                <strong>This action cannot be undone.</strong> The item will be permanently removed from your wardrobe,
                along with any outfit associations and wear history.
            </p>
        </div>

        <div class="item-preview-card">
            <div class="item-preview-grid">
                <div class="item-preview-image">
                    {% if item.image %}
                    <img src="{{ item.image.url }}" alt="{{ item.name }}">
                    {% else %}
                    <div
                        style="color: #999; font-family: 'Inter', sans-serif; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">
                        No image
                    </div>
                    {% endif %}
                </div>
                <div class="item-preview-details">
                    <h3>{{ item.name }}</h3>
                    <ul class="item-detail-list">
                        {% if item.category %}
                        <li>
                            <span class="item-detail-label">Category:</span>
                            {{ item.category.name }}
                        </li>
                        {% endif %}
                        {% if item.brand %}
                        <li>
                            <span class="item-detail-label">Brand:</span>
                            {{ item.brand }}
                        </li>
                        {% endif %}
                        {% if item.color %}
                        <li>
                            <span class="item-detail-label">Color:</span>
                            {{ item.color }}
                        </li>
                        {% endif %}
                        {% if item.times_worn > 0 %}
                        <li>
                            <span class="item-detail-label">Worn:</span>
                            {{ item.times_worn }} time{{ item.times_worn|pluralize }}
                        </li>
                        {% endif %}
                        {% if item.purchase_date %}
                        <li>
                            <span class="item-detail-label">Added:</span>
                            {{ item.purchase_date|date:"M d, Y" }}
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>

        <div class="delete-form-card">
            <div class="form-section-title">Confirm Deletion</div>
            <p style="font-family: 'Inter', sans-serif; font-size: 14px; color: #757575; margin-bottom: 24px;">
                Type <strong style="color: #252320;">"DELETE"</strong> below to confirm you want to permanently remove
                this item.
            </p>

            <form method="post" id="deleteForm">
                {% csrf_token %}
                <div class="input-field">
                    <label for="confirmation" class="input-label">Type "DELETE" to confirm</label>
                    <input type="text" id="confirmation" name="confirmation" class="input-control" required
                        placeholder="DELETE" autocomplete="off">
                </div>

                <div class="form-actions-danger">
                    <a href="{% url 'wardrobe_detail' item.id %}" class="btn-cancel">
                        Cancel
                    </a>
                    <button type="button" class="btn btn-danger btn-lg delete-trigger" data-form-id="deleteForm"
                        data-item-name="{{ item.name }}">
                        Delete Permanently
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="{% static 'js/confirm-modal.js' %}"></script>
<script>
    // Форма validation
    document.getElementById('deleteForm').addEventListener('submit', function (e) {
        const confirmation = document.getElementById('confirmation').value;

        if (confirmation !== 'DELETE') {
            e.preventDefault();
            alert('You must type "DELETE" exactly to confirm deletion.');
            return false;
        }
    });

    // Prevent accidental Enter key submission
    document.getElementById('confirmation').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            e.preventDefault();
        }
    });
</script>
{% endblock %}